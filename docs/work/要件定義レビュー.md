

# **旅行計画アプリケーション『trip-plan』開発計画：要件、アーキテクチャ、および短期スケジュールに関する専門家レビュー報告書**

## **I. エグゼクティブサマリーとレビュー方針**

本報告書は、旅行計画アプリケーション『trip-plan』の開発計画に関して、提供された要件定義書（案）の技術的および法的側面のレビューと詳細化、1ヶ月（土日のみ、計8日間）という厳格な制約下で実行可能な開発スケジュール案、および堅牢な技術基盤を支えるGitHubファイル構成案を提示するものである。

### **1.1. レポートの目的とスコープの定義**

『trip-plan』の開発は、C++およびQtフレームワークを基盤としており、外部サービスとして「駅すぱあと API フリープラン」 の利用を前提としている。本レビューの主要な目的は、この短期間で機能する最小限の製品（Minimum Viable Product: MVP）を確実に構築するために、初期の機能要件を厳格に限定し、特に外部APIの利用に伴う潜在的な法的リスクを最小化するためのアーキテクチャ要件を組み込むことにある。

短期開発において最も重要なのは、開発対象の範囲を明確に定義し、技術的な複雑性を持つ機能（例：高度な地図描画、複雑なサジェスト機能）を後のフェーズに繰り延べることである。このアプローチにより、8日間という限られた期間内で、アプリケーションの核となるロジック、すなわち「検索パラメータの入力」「API連携による経路探索」「結果の表示」の三点を確実に検証し、動作させることを最優先する。

### **1.2. プロジェクトにおける最大のリスク要因**

プロジェクトの成功に対する最も重大な脅威は、技術的な課題ではなく、**APIの利用規約に起因する法的コンプライアンスリスク**である。「駅すぱあと API フリープラン」の利用規約には、「二次利用・転売の禁止」が規定されている 。一般的に、旅程計画アプリにおいてユーザーの検索結果（経路詳細データ、運賃、時刻情報など）をローカルファイルやデータベースに保存する行為は、「APIによって提供されたデータの二次利用」と解釈される可能性が高い。

この法的解釈が確定しない限り、開発者は、ユーザーが入力した「検索条件」（起点、終点、日時）のみをローカルに保存し、APIから取得した「検索結果」（経路詳細）はセッションが終了するか、次の検索が行われる際に破棄されるアーキテクチャを採用しなければならない。要件定義書は、この法的制約を最重要の非機能要件として位置づけ、データ永続化機能の設計を根本的に規定する必要がある。

---

## **II. 要件定義書（案）のレビューと詳細化：システムの定義と法的基盤（添削の核心）**

### **2.1. 機能要件 (FR) の詳細化とMVPスコープの厳格な設定**

#### **FR 1: 旅程計画のコア機能（入力/検索）**

MVP期間における入力インターフェースは、開発速度を最大化するために可能な限りシンプルに設計されなければならない。出発地、目的地、経由地、日時といった基本要素の設定は必須であるが、8日間という制約の中で、ジオコーディング機能（住所から座標への変換）や、駅名・地名の高度な入力候補サジェスト機能をAPI連携初期に組み込むことは、UI処理と外部ライブラリ連携のボトルネックとなる。したがって、MVPでは、ユーザーが駅名または主要地名を正確に入力することを前提とし、高度なUI機能はフェーズ2へ移行する。利用できる交通手段も、利用する駅すぱあとAPIのフリープランが提供する範囲に厳格に限定される 。

経路探索機能の設計においては、将来的な拡張性を確保するため、「ルーティングサービス抽象化レイヤーの定義」を必須の構造要件とする。現状ではEkispart API が唯一のデータソースとなるが、将来的には、オープンソースのルーティングエンジンであるOSRMやGraphHopper といった技術の統合が視野に入る。この抽象化層は、現在のEkispart APIからのレスポンス形式と、将来的な汎用地理情報形式（例：GPX/KML ）との互換性を容易にするための中間データモデルを定義する役割を担う。

#### **FR 2: データ永続化と法的コンプライアンスに準拠した保存**

法的コンプライアンスを遵守しつつ、ユーザーの利便性を確保するため、旅程データモデルは「検索パラメータ」と「経路検索結果（APIデータ）」に明確に分割されなければならない。

**データ保存対象の厳格な分離:**

1. **保存可能データ（ローカルファイルへの書き出し許可）:** ユーザーが入力した検索条件（起点、終点、日時、経由地名）のみが対象となる。これらはユーザー自身の入力データであり、API提供データではないため、保存が許容される。  
2. **保存禁止データ（キャッシュ禁止）:** Ekispart APIから直接取得した詳細な運行データ、運賃、特定の乗り換え情報、全行程の詳細な地理座標リストなど は、二次利用と見なされるリスクを回避するため、厳格にローカル保存やキャッシュが禁止される。

ファイル形式の標準化:  
旅程データの内部保存形式として、QtのQJsonDocumentと親和性の高いJSON形式を標準内部形式として採用する。外部連携用には、GPXエクスポート形式を推奨する 。KML形式はGPXと機能が重複し、短期間の開発スコープでは開発負荷が増すため、MVPスコープから除外することが適切である。GPXエクスポートモジュールは、法的なリスクを回避するため、旅程の主要なウェイポイント（起点、経由地、終点）とそれに関連するメタデータのみを保存するように定義される。これは、詳細な運行情報を含むAPIデータをGPXに無理に格納しようと試みることが、実質的に「APIデータの二次利用」と見なされるリスクを高めることを防ぐための重要な設計上の判断である。GPXを地理座標の交換ツールとしてのみ利用することで、ポータビリティを確保しつつ、法的リスクを最小限に抑えることが可能となる。  
**【テーブル II.A】機能要件優先度マトリクス（法的リスク管理統合）**

| 機能カテゴリー | 機能詳細 | 優先度 (MVP) | 依存関係 | 法務/リスク評価 |
| :---- | :---- | :---- | :---- | :---- |
| 旅程計画 | 入力フォーム (起点/終点/経由地/日時) | P1 (必須) | なし | 低 |
| 経路検索 | 駅すぱあとAPIリアルタイムクエリ実行 | P1 (必須) | Ekispart API | 中 |
| 検索結果表示 | テキストベースのリッチな結果リスト表示 | P1 (必須) | APIレスポンスデータ構造 | 低 |
| データ管理 | 検索パラメーター（Input）のローカル保存 (JSON) | P1 (必須) | JSONライブラリ | 低 (コンプライアンス準拠) |
| データ管理 | GPXエクスポート (ウェイポイントのみ) | P2 (推奨) | GPXライブラリ | 低 (コンプライアンス準拠) |
| 地図表示 | 路線図機能 または外部地図統合 | P3 (繰り延べ) | マッピングライブラリ | 中 (開発工数大) |
| データ管理 | 経路検索結果（詳細ルートデータ）の永続化 | P5 (禁止) | APIライセンス | 極めて高リスク (禁止) |

### **2.2. 法的・ライセンスコンプライアンス要件 (LC \- 最重要要件)**

#### **LC 1: 外部APIのデータ利用ポリシーの徹底**

「駅すぱあと API フリープラン」は無償で提供されるが 、提供規約第15条には「二次利用・転売」の禁止が明確に記載されている 。この二次利用の禁止規定は、API提供サービスを経由せずにデータを利用可能にする行為、すなわち詳細な経路検索結果のローカルファイルへの保存やキャッシュも含む広義な解釈がなされる可能性が高い。

したがって、要件定義書には、「APIデータのローカルキャッシュまたは永続化は、API提供者から明確な書面による許可が得られるまで、厳格に禁止する」という強制力の高い非機能要件を明記する必要がある。この制約はアプリケーションのオフライン機能や高速な再検索機能の実現を妨げるが、短期開発における法的リスクを排除するための最善かつ必須の戦略である。

さらに、アプリケーションのユーザーインターフェース（UI）内には、経路検索結果が「駅すぱあと」によって提供されたデータに基づいている旨を明瞭に表示する義務を定義する必要がある 。これは著作権および商標表示の観点から求められる基本的なコンプライアンス要件である。

#### **LC 2: 代替技術（OSRM/GraphHopper）のライセンス要件**

将来的に、地理情報システムの汎用性を高めるためにOSRMやGraphHopper のようなオープンソース技術を統合する場合、これらのエンジンが主にOpenStreetMap（OSM）データを利用することに注意が必要である。OSMデータはODbL（Open Database License）の下で提供されており、OSMデータを使用した派生データベースの共有、および適切な帰属表示が義務付けられる。フェーズ2以降にこれらの技術を統合する際には、アプリケーション内にODbLに基づく帰属表示義務を非機能要件として組み込む必要がある。

### **2.3. 非機能要件 (NFR) の強化**

**メンテナンス性 (NFR 3):** C++/Qt環境 でのプロジェクトは、他の高水準言語環境と比較して、メモリ管理やビルド設定が複雑化しやすい傾向にある。このため、保守性を確保し、バグの発生を抑制するために、コードのモジュール化（API Wrapper、UI、Core Logicの明確な分離）を徹底することが必須要件となる。

**開発環境 (NFR 4):** Qtのクロスプラットフォーム互換性 を最大限に活用し、異なるオペレーティングシステム間でのビルド手順を一貫させるため、標準ビルドシステムとしてCMakeを採用する。これにより、プロジェクトの構成ファイル管理が一元化され、開発チーム全体の効率が向上する。

---

## **III. 技術アーキテクチャ提言とGitHubファイル構成案**

### **3.1. 推奨技術スタックとアーキテクチャモデル**

本プロジェクトでは、C++とQtの組み合わせが採用される。このスタックは、ネイティブアプリケーションレベルのパフォーマンスと、デスクトップ環境におけるクロスプラットフォーム互換性を提供可能である。しかし、8日間という制約の中で開発速度を維持するため、プロジェクト初期段階においては、標準のQtクラス（QNetworkAccessManagerによるネットワーク通信、QJsonDocumentによるデータ処理、QFileによるI/Oなど）の使用を優先し、外部の複雑なサードパーティライブラリへの依存を最小限に抑えることが戦略的に重要である。

**アーキテクチャの推奨：三層アーキテクチャの採用**

システムの関心を分離し、テスト容易性およびメンテナンス性を高めるため、以下の三層アーキテクチャを採用することを強く推奨する。

1. **Presentation Layer (UI/UX):** Qt WidgetsまたはQMLを使用して実装される。ユーザーとの対話、入力値の検証、結果の描画を担当する。  
2. **Domain/Business Logic Layer (Core):** C++クラス群で構成され、データモデルの管理、ルーティングロジック（現時点では検索パラメータの組み立て）、およびデータ変換（APIレスポンスから内部モデルへの変換）といったアプリケーションの核となる処理を担う。  
3. **Data Access Layer (DAL):** 外部システムとのインターフェースとなる。具体的には、EkispartClientがAPI通信を担当し、PersistenceManagerがJSON/GPX ファイルの読み書きを担当する。

将来的な拡張ポイントとして、OSRMやGraphHopper のようなオープンソースのルーティングエンジンを統合する際は、DAL層に汎用的なルーティングインターフェースを定義し、APIやエンジンに依存しない形でロジック層が利用できるように設計されるべきである。

### **3.2. データ永続化戦略とモデル定義**

法的制約を遵守するためのデータ戦略として、データモデルを厳密に定義し、保存対象と破棄対象を分離する。

* **SearchParameters Class:** 起点、終点、経由地、日時などのユーザー入力情報を格納する。このクラスのインスタンスのみが、ローカルに永続化される対象となる。  
* **RouteResponse Class:** Ekispart APIからリアルタイムで取得される一時的な詳細経路データを格納する。このインスタンスは、アプリケーションの設計上、セッション終了時または次の検索時に確実に破棄されなければならない。

データのシリアル化には、Qtの標準JSONライブラリ (QJsonDocument) を使用して、SearchParametersクラスをJSON形式でローカルファイルに安全に保存する。GPXエクスポートモジュールは、この保存されたパラメーターを基に再度APIをクエリし、取得したルートデータから、法的リスクを伴わない**主要なウェイポイントデータ**のみを選別し、GPX形式に変換して出力する役割を担う。

### **3.3. GitHubリポジトリ ファイル・ディレクトリ構成案**

C++およびCMakeを標準とするQtプロジェクトにおいて、モジュラー設計とCI/CD対応を容易にするための標準的なファイル・ディレクトリ構成案を以下に示す。APIキーなどの秘密情報は、セキュリティ上の理由から、コードやリポジトリ本体から分離し、環境変数またはローカル設定ファイル経由で管理されることが必須である。

**【テーブル III.A】GitHubリポジトリ ファイル・ディレクトリ構成案**

| ディレクトリ/ファイル | 役割 | 説明 |
| :---- | :---- | :---- |
| / | ルート | README.md (ビルド手順, 依存関係)、.gitignore (秘密情報ファイルの除外設定) |
| /src | アプリケーションソースコード | C++の実行ファイルと主要モジュールが格納される。 |
| /src/Model | データモデル | SearchParameters, RouteResponseなど、データ構造の定義。 |
| /src/Core | ビジネスロジック | ルート計算ロジック、データ変換処理、エラーハンドリングロジック。 |
| /src/UI | ユーザーインターフェース | Qt Widgets/QML ファイル、UIイベント処理ロジック。 |
| /src/API | 外部連携モジュール | EkispartClient (APIラッパー)、認証ロジック、データリクエスト処理。 |
| /src/Persistence | データ永続化 | JsonManager (パラメーター保存)、GpxExporter 。コンプライアンス遵守のためのロジックを厳格に実装。 |
| /tests | テストコード | ユニットテストおよび統合テストコードを配置。APIラッパーやデータモデルの正確性を検証。 |
| /docs | ドキュメント | 要件定義書、アーキテクチャ文書、API利用規約の解釈 など、プロジェクトの意思決定記録を格納。 |
| /config | 設定ファイル | APIキーなどの環境固有設定ファイル（テンプレートを配置）。 |
| CMakeLists.txt | ビルド設定 | C++/Qtプロジェクトの標準的なビルド定義ファイル。 |

---

## **IV. 1ヶ月（土日8日間）開発スケジュールとリソース計画**

8日間の開発期間でMVPを達成するためには、タスクを最小単位に分割し、依存関係に基づいて厳密に実行順序を管理することが不可欠である。クリティカルパスとなるのは、「API連携の確立」と「法的制約下でのデータ永続化の実装」である。この計画は、1日8時間の高集中作業を前提とする。

### **4.1. スケジュール作成の前提条件とスコープの限定**

MVPのスコープは、セクションIIで定義された通り、「経路検索の入力」「APIコール」「テキスト表示」「検索パラメーターの保存」のコア機能のみに厳しく限定される。地図描画や高度なエラーリカバリ機能は、この期間では実現不可能であると判断し、フェーズ2へ繰り延べる。

API接続問題は短期開発における最大の技術リスクの一つであるため、スケジュールは早期のAPI接続検証を組み込む必要がある。Day 3までにAPI接続に失敗した場合、残りの開発リソースは直ちに問題解決に集中投入されるべきであり、UI開発などは停止される。

#### **4.2. フェーズ別タスク分解と実行計画 (8日間マッピング)**

タスクは、アーキテクチャの基盤（データモデル、ビルドシステム）から始まり、DAL層（API）、Core層（データ処理）、最後にPresentation層（UI）の順で実行される。

**【テーブル IV.A】1ヶ月（土日8日間）開発タスクスケジュール詳細**

| Day No. | フェーズ | 主要タスク (概算工数) | 目標成果物 | クリティカルパス |
| :---- | :---- | :---- | :---- | :---- |
| **1 (土)** | 環境構築・計画確定 | 1.1. 要件/データモデル最終確認、JSONスキーマ設計 (4h) 1.2. C++/Qt開発環境セットアップ、GitHub/CMake設定 (4h) | 開発環境の動作確認完了、データモデルのC++定義、リポジトリ構成 (III.C) 完了。 | Yes |
| **2 (日)** | アーキテクチャ/API基盤 | 2.1. APIラッパー（EkispartClient）インターフェース定義とモック実装 (5h) 2.2. JSON I/Oモジュール（読み書き）のプロトタイプ実装 (3h) | APIモック経由でのデータフロー検証、検索パラメーター保存機能の骨子実装。 | Yes |
| **3 (土)** | コア機能実装 1 (API連携) | 3.1. Ekispart APIへの認証処理とリアルタイム連携の実装 (6h) 3.2. APIキーの安全な管理（環境変数化）の実装 (2h) | APIからの実データ取得テスト成功。 | Yes |
| **4 (日)** | コア機能実装 2 (データ処理) | 4.1. APIレスポンスから内部データモデルへの変換ロジック実装 (6h) 4.2. 検索結果の簡易表示（テキストテーブル）実装 (2h) | 検索機能の内部動作完了、データマッピングの正確性の検証。 | Yes |
| **5 (土)** | UI/UX 1 (入力フォーム) | 5.1. Qt Widgets/QMLを使用した入力フォームの実装 (5h) 5.2. UIとCoreロジックの接続（入力データのAPIへの連携） (3h) | ユーザーが操作可能な基本的なGUIの確立。 | No |
| **6 (日)** | UI/UX 2 (結果/I/O) | 6.1. 検索結果の詳細表示UIの実装 (4h) 6.2. 検索パラメーターのローカル保存/読み込み機能統合 (4h) | ファイルI/O機能の統合、コンプライアンス遵守のため、保存機能の再検証。 | Yes |
| **7 (土)** | テスト・品質保証 | 7.1. 統合テスト（機能、応答時間）の実行とバグ修正 (6h) 7.2. データコンプライアンス監査（ローカルファイルに禁止データが含まれていないかの厳格な確認） (2h) | 主要バグの解消、法的要件の遵守証明。 | Yes |
| **8 (日)** | 最終レビュー・デプロイ | 8.1. コード最終レビュー、ドキュメント更新（README, ユーザガイド） (5h) 8.2. クロスプラットフォーム向けリリースビルドとMVPローンチ準備 (3h) | 動作可能なMVP (v1.0.0) の完成、次フェーズへのタスク洗い出し。 | No |

### **4.3. リスク要因と軽減戦略**

リスク要因 1: C++/Qt環境特有のビルド/リンクエラーやメモリ管理の複雑性。  
C++ネイティブ開発は、依存関係の解決やメモリリークのリスクを常に伴う。

* **軽減戦略:** Day 1とDay 2にQtの標準的な依存関係のみでコンパイルが成功することを徹底する。また、ネイティブC++の複雑な機能（生ポインタ管理など）は避け、Qtの提供する安全なスマートポインタやコンテナクラスを積極的に利用することで、コードの堅牢性を高める。

リスク要因 2: APIの利用規約違反によるアカウント停止または法的問題の発生 。  
これがプロジェクト失敗の最大の要因となる可能性が高い。

* **軽減戦略:** Day 7に「データコンプライアンス監査」を組み込み、実際にローカルに保存されたJSONファイルやGPXファイルを開き、\*\*詳細な経路検索結果（運賃、時刻表、詳細な経由地リストなど）\*\*が意図せず含まれていないかを、コードレベルとデータ出力レベルの両方で厳格に手動確認する。この監査プロセスが、法的リスク管理の最終防衛線となる。

---

## **V. 結論：次なる開発フェーズへのロードマップ提言**

### **5.1. MVP達成後のロードマップ (フェーズ2: 拡張性)**

MVPが法的リスクを最小限に抑えた上でコア機能（検索とコンプライアンス準拠のパラメータ保存）を提供した後、フェーズ2ではユーザーエクスペリエンス（UX）の向上と、アプリケーションの汎用性を高めるための拡張に着手する。

1. 地図描画の統合:  
   現在のMVPではテキストベースの表示に留まっているが、地図描画は旅行計画アプリのUXを劇的に向上させる。Ekispart APIには路線図機能の利用オプションが存在する 。フェーズ2ではまず、この機能の利用可能性と技術的な統合難易度を評価すべきである。あるいは、代替手段として、オープンストリートマップ（OSM）ベースの地図タイルをC++/Qt環境で描画するライブラリ（例：Qt Location/Map API）の選定と統合を行うことで、独自の地図表示機能を実現する。  
2. ルーティングエンジンの拡充:  
   アプリケーションの汎用性を高めるため、OSRMまたはGraphHopper のようなオープンソースのルーティングエンジンの統合に着手する。これにより、鉄道以外の国際的なルート、徒歩、自動車の経路検索などが可能となる。フェーズ2では、セクションIIIで定義したルーティング抽象化レイヤーを完成させ、Ekispartとオープンソースエンジンが並行して利用可能な構造を構築することが目標となる。

### **5.2. 専門的推奨事項：法的戦略の強化**

現行のMVP計画は、無償のEkispart API の利用規約、特に二次利用禁止規定 を厳格に遵守するために、機能の一部（経路詳細の保存）を犠牲にしている。これは短期開発および法的リスク回避のための適切な判断である。

しかし、アプリケーションを長期的に拡張し、オフライン機能の提供や、過去の検索結果に基づく統計処理など、より高度な機能（すなわち、経路詳細データの永続化を伴う機能）を実現するためには、現在の法的制約がボトルネックとなる。

したがって、将来的にアプリケーションを収益化（商用化）する計画がある場合、**フェーズ2を開始する前に**、次の行動を強く推奨する。

* **API提供元への正式な問い合わせ:** 駅すぱあとAPIの有償プランへの移行を検討し、特に「経路検索結果のローカルキャッシュ/データベース保存」が許可されるかどうかについて、API提供元に対して正式に書面で問い合わせを行う。  
* **契約変更:** 有償プラン契約により、データ永続化に関する明確な利用許諾を得る。

この確認プロセスと契約変更は、アプリケーションの拡張性、特にオフライン機能や高速な再検索機能の実現を決定づける最重要ポイントとなる。この法的基盤の強化なくして、長期的に競争力のある旅行計画アプリケーションを開発し続けることは困難である。

#### **引用文献**

1. 「駅すぱあと API フリープラン」 利用お申し込み, 11月 23, 2025にアクセス、 [https://api-info.ekispert.com/form/free/](https://api-info.ekispert.com/form/free/)  
2. 1月 1, 1970にアクセス、 [駅すぱあと API 二次利用 禁止 ローカル保存 解釈](http://docs.google.com/駅すぱあと%20API%20二次利用%20禁止%20ローカル保存%20解釈)  
3. 1月 1, 1970にアクセス、 [OSRM GraphHopper C++ Qt 統合 チュートリアル](http://docs.google.com/OSRM%20GraphHopper%20C++%20Qt%20統合%20チュートリアル)  
4. 1月 1, 1970にアクセス、 [Qt C++ ファイル保存 GPX KML JSON メリット デメリット](http://docs.google.com/Qt%20C++%20ファイル保存%20GPX%20KML%20JSON%20メリット%20デメリット)